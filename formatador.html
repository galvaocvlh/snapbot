<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Formatador Profissional de Jogos</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #f4f6f8;
      margin: 0;
      padding: 20px;
      color: #333;
    }
    h1 {
      text-align: center;
      color: #2c3e50;
      margin-bottom: 20px;
    }
    button {
      padding: 8px 15px;
      font-size: 14px;
      margin: 5px 5px 10px 0;
      cursor: pointer;
      border: none;
      border-radius: 5px;
      transition: all 0.2s ease;
    }
    button:hover {
      opacity: 0.9;
    }
    #extrairBtn {
      background-color: #3498db;
      color: white;
    }
    #exportBtn {
      background-color: #2ecc71;
      color: white;
    }
    .btn-excluir {
      background-color: #e74c3c;
      color: white;
    }
    input[type="text"] {
      padding: 8px;
      width: 300px;
      margin: 10px 0;
      border-radius: 5px;
      border: 1px solid #ccc;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
      background-color: #fff;
      border-radius: 8px;
      overflow: hidden;
    }
    th, td {
      padding: 10px;
      text-align: center;
      border-bottom: 1px solid #ccc;
    }
    th {
      background-color: #34495e;
      color: #fff;
      position: sticky;
      top: 0;
      z-index: 1;
    }
    tbody tr:nth-child(even) {
      background-color: #ecf0f1;
    }
    .radio-group label {
      margin: 0 10px;
      font-size: 14px;
      font-weight: bold;
      cursor: pointer;
    }
    .sim { color: #27ae60; }     /* Verde */
    .neutro { color: #000000; }  /* Preto */
    .nao { color: #e74c3c; }     /* Vermelho */

    @media(max-width: 768px) {
      table, th, td {
        font-size: 14px;
      }
      button {
        font-size: 13px;
      }
    }
  </style>
</head>
<body>
  <h1>Formatador Profissional de Jogos</h1>

  <button id="extrairBtn" onclick="extrair()">Extrair Jogos do Clipboard</button>
  <button id="exportBtn" onclick="exportarExcel()">Exportar para Excel</button>

  <input type="text" id="filtro" placeholder="Filtrar jogos..." onkeyup="filtrar()">

  <table id="tabelaJogos">
    <thead>
      <tr>
        <th>Jogo</th>
        <th>BTTS</th>
        <th>Mais 2,5 Gols</th>
        <th>A√ß√µes</th>
      </tr>
    </thead>
    <tbody>
    </tbody>
  </table>

  <script>
    let todosJogos = [];

    async function extrair() {
      try {
        const texto = await navigator.clipboard.readText();
        processarJogos(texto);
      } catch (err) {
        alert('N√£o foi poss√≠vel acessar a √°rea de transfer√™ncia. Copie os dados e tente novamente.');
        console.error(err);
      }
    }

    function processarJogos(texto) {
      const linhas = texto.split('\n').map(l => l.trim()).filter(l => l !== '');
      const tbody = document.querySelector('#tabelaJogos tbody');
      tbody.innerHTML = '';
      todosJogos = [];

      let hora = '';
      let times = [];

      linhas.forEach(linha => {
        if (linha.includes('Classifica√ß√£o') || linha === '-' || linha === '') return;

        if (/^\d{2}:\d{2}$/.test(linha)) {
          hora = linha;
          times = [];
        } else if (hora) {
          if (!times.includes(linha)) times.push(linha);
          if (times.length === 2) {
            const jogoTexto = `${hora} - ${times[0]} x ${times[1]}`;
            todosJogos.push(jogoTexto);

            const tr = document.createElement('tr');
            const tdJogo = document.createElement('td');
            tdJogo.textContent = jogoTexto;
            tr.appendChild(tdJogo);

            // Coluna BTTS
            const tdBTTS = document.createElement('td');
            tdBTTS.className = 'radio-group';
            tdBTTS.innerHTML = `
              <label class="sim"><input type="radio" name="btts-${jogoTexto}" value="Sim"> Sim</label>
              <label class="neutro"><input type="radio" name="btts-${jogoTexto}" value="Neutro"> Neutro</label>
              <label class="nao"><input type="radio" name="btts-${jogoTexto}" value="N√£o"> N√£o</label>
            `;
            tr.appendChild(tdBTTS);

            // Coluna Mais 2,5 Gols
            const tdGols = document.createElement('td');
            tdGols.className = 'radio-group';
            tdGols.innerHTML = `
              <label class="sim"><input type="radio" name="over-${jogoTexto}" value="Sim"> Sim</label>
              <label class="neutro"><input type="radio" name="over-${jogoTexto}" value="Neutro"> Neutro</label>
              <label class="nao"><input type="radio" name="over-${jogoTexto}" value="N√£o"> N√£o</label>
            `;
            tr.appendChild(tdGols);

            // Coluna A√ß√µes
            const tdAcao = document.createElement('td');
            const btnExcluir = document.createElement('button');
            btnExcluir.textContent = "üóëÔ∏è Excluir";
            btnExcluir.className = "btn-excluir";
            btnExcluir.onclick = () => excluirJogo(jogoTexto, tr);
            tdAcao.appendChild(btnExcluir);
            tr.appendChild(tdAcao);

            tbody.appendChild(tr);
            times = [];
            hora = '';
          }
        }
      });
    }

    function excluirJogo(jogo, linha) {
      todosJogos = todosJogos.filter(j => j !== jogo);
      linha.remove();
    }

    function exportarExcel() {
      let csv = 'Jogo;BTTS;Mais 2,5 Gols\n';

      todosJogos.forEach(jogo => {
        const btts = document.querySelector(`input[name="btts-${jogo}"]:checked`);
        const gols = document.querySelector(`input[name="over-${jogo}"]:checked`);
        if (btts || gols) {
          const bttsVal = btts ? btts.value : '';
          const golsVal = gols ? gols.value : '';
          csv += `"${jogo}";"${bttsVal}";"${golsVal}"\n`;
        }
      });

      const blob = new Blob(["\uFEFF" + csv], { type: 'text/csv;charset=utf-8;' });
      const link = document.createElement('a');
      link.href = URL.createObjectURL(blob);
      link.download = 'jogos_selecionados.csv';
      link.click();
    }

    function filtrar() {
      const filtro = document.getElementById('filtro').value.toLowerCase();
      const tbody = document.querySelector('#tabelaJogos tbody');
      tbody.querySelectorAll('tr').forEach(tr => {
        const jogo = tr.cells[0].textContent.toLowerCase();
        tr.style.display = jogo.includes(filtro) ? '' : 'none';
      });
    }
  </script>
</body>
</html>
